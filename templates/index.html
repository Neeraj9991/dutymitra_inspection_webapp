<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>SGV Night Check Report Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-6">
          <div class="card shadow-sm">
            <div class="card-body">
              <h3 class="card-title mb-3 text-center">
                SGV Night Check Report Generator
              </h3>
              <p class="text-muted text-center mb-4">
                Enter Google Sheet details and select a date to generate
                <strong>DOCX reports</strong> or preview & print one report.
              </p>

              <!-- Flash messages -->
              {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                  {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                      {{ message }}
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                  {% endfor %}
                {% endif %}
              {% endwith %}

              <form method="post" enctype="multipart/form-data">
                <div class="mb-3">
                  <label for="sheet_input" class="form-label">Google Sheet URL or Sheet ID</label>
                  <input
                    type="text"
                    class="form-control"
                    id="sheet_input"
                    name="sheet_input"
                    placeholder="Paste Google Sheet link or ID"
                    required
                  />
                  <div class="form-text">
                    Sheet must be shared as
                    <strong>Anyone with the link â†’ Viewer</strong>.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="gid" class="form-label">Worksheet gid (optional)</label>
                  <input
                    type="text"
                    class="form-control"
                    id="gid"
                    name="gid"
                    placeholder="e.g. 0"
                  />
                  <div class="form-text">
                    Leave blank for the first sheet.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="date" class="form-label">Night Check Date</label>
                  <input
                    type="date"
                    class="form-control"
                    id="date"
                    name="date"
                    required
                  />
                </div>

                <div class="mb-3">
                  <label for="template_file" class="form-label">Upload DOCX Template (optional)</label>
                  <input
                    class="form-control"
                    type="file"
                    id="template_file"
                    name="template_file"
                    accept=".docx"
                  />
                  <div class="form-text">
                    If you don't upload, the default <code>template.docx</code> in the project root will be used.
                  </div>
                </div>

                <div class="d-grid gap-2">
                  <button type="submit" name="action" value="download_zip" class="btn btn-primary">
                    Generate DOCX ZIP
                  </button>
                  <button type="submit" name="action" value="preview" class="btn btn-outline-secondary">
                    Preview & Print First Report
                  </button>
                </div>
              </form>
            </div>
          </div>
          <p class="text-center text-muted small mt-3">
            You can change the report format anytime by uploading a new DOCX template.
          </p>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
